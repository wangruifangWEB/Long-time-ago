<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>我的徒步</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">
    <META HTTP-EQUIV="Expires" CONTENT="0">
    <link rel="stylesheet" type="text/css" href="../../css/reset.css" />
    <link rel="stylesheet" type="text/css" href="../../css/style.css" />
    <link rel="stylesheet" href="../../css/css.css" />
    <link rel="stylesheet" href="../../css/mui.picker.all.css" />
    <script src="../../js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/swiper.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="../../js/fontSize.js" type="text/javascript" charset="utf-8"></script>
    <link rel="stylesheet" href="../../single_css/global.css">
    <style>
    body {
        background-color: #ececec;
        overflow: scroll;
        font-family: PingFangSC-Regular;
    }

    .swiper-container,
    .w {
        height: 100vh;
    }

    .outerScroller {
        width: 7.5rem;
        margin: 0 auto;
    }

    .scroll {
        position: relative;
        overflow: hidden;
    }

    header{
        position: fixed;
        box-shadow: none;
    }
    header img{
        width: 0.2rem;
        height: 0.35rem;
        position: absolute;
        top: 0.32rem;
        left: 0.6rem;
        z-index: 100;
    }
    header span{
        width: 100%;
        height: 0.98rem;
        font-size: 0.37rem;
        color: #3c3c40;
        line-height: 0.98rem;
        display: block;
        text-align: center;
    }
    .init-loading img {
        width: 1.2rem;
        height: 1.2rem;
        display: block;
        margin: 0.05rem auto;
    }
    .init-loading img {
        width: 1.2rem;
        height: 1.2rem;
        display: block;
        margin: 0.05rem auto;
    }

    .loadtip p {
        font-size: 0.26rem;
        height: 0.4rem;
        line-height: 0.4rem;
        position: fixed;
        bottom: 0;
        width: 7.5rem;
        text-align: center;
        background-color: #ececec;
        z-index: 10;
        font-size: 0.26rem;
    }

    .active_list {
        margin-top: 0.98rem;
        width: 7.5rem;
    }

    .active_list_ul li {
        height: auto;
        background-color: #ffffff;
        margin-bottom: 0.2rem;
        height: 2.02rem;
    }

    .active_left {
        float: left;
        padding-left: 0.82rem;
        color: #4d4d4d;
        font-size: .32rem;
    }

    .active_left div:nth-child(1) img {
        width: .46rem;
        height: .3rem;
        margin-top: .31rem;
        margin-right: .26rem;
        display: inline-block;
    }

    .active_left div:nth-child(1) span {
        margin-top: 0.3rem;
        line-height: .31rem;
        height: .31rem;
    }

    .active_left div:nth-child(2),
    .active_left div:nth-child(3) {
        margin-top: .34rem;
        height: .25rem;
    }

    .active_left div:nth-child(3) {
        margin-top: .2rem;
    }

    .active_left div:nth-child(2) p,
    .active_left div:nth-child(3) p {
        line-height: .25rem;
        display: inline-block;
        margin-right: .1rem;
        font-size: .26rem;
        height: .25rem
    }

    .active_right {
        float: right;
        margin-right: .5rem;
    }

    .active_right button {
        width: 1.58rem;
        height: .78rem;
        text-align: center;
        line-height: .78rem;
        margin-top: .62rem;
        display: block;
        background-color: #23c92b;
        border-radius: .12rem;
        color: #f6f6f6;
        font-size: .32rem;
    }
    </style>
</head>

<body>
    <div class="outerScroller">
        <div class="scroll">
            <header>
                <img class="back" src="../../images/back.png" alt="" />
                <span>我参加的活动</span>
            </header>
            <div class="active_list">
                <div class="swiper-container">
                    <div class="swiper-wrapper w">
                        <div class="swiper-slide d">
                            <div class="init-loading list-group-item text-center" style="display: none;"><img src="../../images/loading.gif" /></div>
                            <div class="swiper-container2">
                                <div class="swiper-slide list-group">
                                    <ul class="active_list_ul">
                                        <li>
                                            <a href="javascript:;">
                                                <div class="active_left">
                                                    <div><img src="../../images/order_team.png" alt=""><span>中国美术馆</span></div>
                                                    <div>
                                                        <p>活动地点：</p>
                                                        <p>北京石景山</p>
                                                    </div>
                                                    <div>
                                                        <p>活动时间：</p>
                                                        <p>2017-10-15</p>
                                                    </div>
                                                </div>
                                                <div class="active_right">
                                                    <button>地点打卡</button>
                                                </div>
                                            </a>
                                        </li>
                                        <li>
                                            <a href="javascript:;">
                                                <div class="active_left">
                                                    <div><img src="../../images/order_team.png" alt=""><span>中国美术馆</span></div>
                                                    <div>
                                                        <p>活动地点：</p>
                                                        <p>北京石景山</p>
                                                    </div>
                                                    <div>
                                                        <p>活动时间：</p>
                                                        <p>2017-10-15</p>
                                                    </div>
                                                </div>
                                                <div class="active_right">
                                                    <button>地点打卡</button>
                                                </div>
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="loadtip">
                        <p></p>
                    </div>
                    <div class="swiper-scrollbar"></div>
                </div>
            </div>
        </div>
    </div>
    <script>
    $('.back').click(function(){
        history.go(-1);
    })
    $('.active_list').height($(window).height()-$('header').height());
    $('.swiper-container,.w').height($(window).height()-$('header').height());
    var loadFlag = true;
    var oi = 0;
    var mySwiper = new Swiper('.swiper-container', {
        direction: 'vertical',
        scrollbar: '.swiper-scrollbar',
        slidesPerView: 'auto',
        mousewheelControl: true,
        freeMode: true,
        onTouchMove: function(swiper) { //手动滑动中触发
            var _viewHeight = document.getElementsByClassName('swiper-wrapper')[0].offsetHeight;
            var _contentHeight = document.getElementsByClassName('swiper-slide')[0].offsetHeight;
        },
        onTouchEnd: function(swiper) {
            var _viewHeight = document.getElementsByClassName('swiper-wrapper')[0].offsetHeight;
            var _contentHeight = document.getElementsByClassName('swiper-slide')[0].offsetHeight;

            // 上拉加载
            if (mySwiper.translate <= _viewHeight - _contentHeight - 50 && mySwiper.translate < 0) {
                $.ajax({
                    url: "http://www.baidu.com",
                    type: "post",
                    success: function(data) {

                    },
                    error: function() {
                        $(".loadtip p").show();
                        if (loadFlag) {
                            $(".loadtip p").html('正在加载...');
                        } else {
                            $(".loadtip p").html('没有更多啦！');
                        }

                        setTimeout(function() {
                            for (var i = 0; i < 3; i++) {
                                $(".active_list .active_list_ul").eq(mySwiper2.activeIndex).append(`
											<li>
												<a href="javascript:;">
													<div class="active_left">
														<div><img src="../../images/order_team.png" alt=""><span>中国美术馆</span></div>
														<div><p>活动地点：</p><p>北京石景山</p></div>
														<div><p>活动时间：</p><p>2017-10-15</p></div>
													</div>
													<div class="active_right">
														<button>地点打卡</button>
													</div>
												</a>
											</li>
										`);
                            }
                            $('.active_list_ul li:nth-last-child(1)').css({'margin-bottom':'0.2rem'});
                            $(".loadtip p").hide();
                            
                            mySwiper.update(); // 重新计算高度;

                        }, 800);
                    }
                });
            }
            //  刷新
            if (mySwiper.translate >= 50) {
                $.ajax({
                    url: "",
                    type: "post",
                    success: function(data) {

                    },
                    error: function() {
                        $('.init-loading').css('display', 'block');
                        setTimeout(function() {
                            for (var i = 0; i < 3; i++) {
                                $(".active_list .active_list_ul").eq(mySwiper2.activeIndex).append(`
											<li>
												<a href="javascript:;">
													<div class="active_left">
														<div><img src="../../images/order_team.png" alt=""><span>中国美术馆</span></div>
														<div><p>活动地点：</p><p>北京石景山</p></div>
														<div><p>活动时间：</p><p>2017-10-15</p></div>
													</div>
													<div class="active_right">
														<button>地点打卡</button>
													</div>
												</a>
											</li>
										`);
                            }
                            $('.init-loading').css('display', 'none');
                            mySwiper.update(); // 重新计算高度;
                        }, 800);
                    }
                });
            }

            //				}else if(mySwiper.translate >= 0 && mySwiper.translate < 50){
            //					$(".init-loading").html('').hide();
            //				}
            return false;
        }
    });
    var mySwiper2 = new Swiper('.swiper-container2', {
        onTransitionEnd: function(swiper) {
            //				$('.w').css('transform', 'translate3d(0px, 0px, 0px)')
            $('.swiper-container2 .swiper-slide-active').css('height', 'auto').siblings('.swiper-slide').css('height', '0px');
            mySwiper.update();
            $('.tab a').eq(mySwiper2.activeIndex).addClass('active').siblings('a').removeClass('active');
        }

    });
    </script>
</body>

</html>