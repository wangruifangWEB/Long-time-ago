<!DOCTYPE html>
<html lang="en" style="font-size: 40px;">

<head>
    <meta charset="UTF-8">
    <title>最美巴马</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
    <link rel="stylesheet" href="../../css/reset.css">
    <link rel="stylesheet" href="../../css/jquery-weui.css">
    <link rel="stylesheet" href="../../css/beauty/beauty_detail.css">
    <link rel="stylesheet" href="../../css/global.css">
    <script src="../../js/jquery.min.js"></script>
    <script type='text/javascript' src='../../js/swiper.js' charset='utf-8'></script>
    <script src="../../js/fastclick.js"></script>
    <script src="../../js/common.js"></script>
    <script src="../../js/jquery-weui.min.js"></script>
</head>

<body ontouchstart>
    <div class="index">
        <div class="beauty_title">
            <p>最美巴马——图片</p>
        </div>
        <div class="beauty_pic">
            <p class="beauty_pic_title">好山好水好巴马好山好水好巴马好山好水好巴马</p>
            <img class="beauty_pic_img" src="../../img/active_detail.jpg" alt="">
        </div>
        <div class="beauty_info">
            <ul class="beauty_info_ul">
                <li class="beauty_info_add"><img src="../../img/beauty_add.png" alt=""><span>河池市巴马瑶族自治县甲篆乡</span></li>
                <li class="beauty_info_time"><img src="../../img/beauty_time.png" alt=""><span>昵称2018年2月4日</span></li>
            </ul>
            <div class="beauty_info_intro">
                <img src="../../img/comment_pic.jpg" alt="">
                <span>一颗大橙子</span>
            </div>
            <div class="beauty_title_like">
                <img src="../../img/beauty_commont_like.png" alt="">
                <span>1212</span>
            </div>
        </div>
        <div class="commont_warp">
            <ul class="commont_title">
                <li class="commont_title_commont"><span class="line"></span><span>评论</span><span>516</span></li>
            </ul>
            <div class="commont_info">
                <div class="commont_info_list clearfix">
                    <div class="commont_info_left">
                        <img src="../../img/comment_pic.jpg" alt="">
                    </div>
                    <div class="commont_info_right">
                        <p class="commont_name">昵称</p>
                        <p class="commont_cont">21212sdjwduewiwudewiuhfwufewufiwuhfiwufiewfiewefbciewubckewjcbewfuewiufrifcbkdcnsk</p>
                        <div class="commont_like">
                            <img src="../../img/all_commont_like.png" alt="">
                            <span>2125</span>
                        </div>
                    </div>
                </div>
                <div class="commont_info_list clearfix">
                    <div class="commont_info_left">
                        <img src="../../img/comment_pic.jpg" alt="">
                    </div>
                    <div class="commont_info_right">
                        <p class="commont_name">昵称</p>
                        <p class="commont_cont">21212sdjwduewiwudewiuhfwufewufiwuhfiwufiewfiewefbciewubckewjcbewfuewiufrifcbkdcnsk</p>
                        <div class="commont_like">
                            <img src="../../img/all_commont_like.png" alt="">
                            <span>2125</span>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
        <div class="weui-loadmore">
            <i class="weui-loading"></i>
            <span class="weui-loadmore__tips">正在加载</span>
        </div>
        <div class="operate">
            <div class="beauty_commont" contenteditable="true" oninput="commont()">请输入评论内容</div>
            <div class="beauty_collect"><img src="../../img/beauty_commont_collect.png" alt=""><span>收藏</span></div>
        </div>
    </div>
</body>
<script>
function commont(){
    $('.operate').height($('.beauty_commont').outerHeight()+20);
}
//监听滚动事件
$(".index").scroll(function() {
    mTop = $('.commont_warp').offset().top;
    if(mTop<=0){
        $('.commont_title').css({'position':'fixed','top':'0','z-index':'100'});
        $('.commont_info').css({'margin-top':'2.5rem'});
    }else{
        $('.commont_title').css({'position':'static'});
        $('.commont_info').css({'margin-top':'0'});
    }
});
$('.index').height($(window).height());
$('.index').css({'overflow-y':'scroll'});
$('.index').infinite().on("infinite", function() {
    setTimeout(function() {
        $(".commont_info").append(`
            <div class="commont_info_list clearfix">
                <div class="commont_info_left">
                    <img src="../../img/comment_pic.jpg" alt="">
                </div>
                <div class="commont_info_right">
                    <p class="commont_name">昵称</p>
                    <p class="commont_cont">21212sdjwduewiwudewiuhfwufewufiwuhfiwufiewfiewefbciewubckewjcbewfuewiufrifcbkdcnsk</p>
                    <div class="commont_like">
                        <img src="../../img/all_commont_like.png" alt="">
                        <span>2125</span>
                    </div>
                </div>
            </div>
        `);
    }, 1000);
})
// 点击评论内容调键盘
// $('.commont_cont').on('click',function(){
//     $('.beauty_commont').trigger('focus');
//     setTimeout(function(){
//         document.body.scrollTop = document.body.scrollHeight;
//     },300);
// })

// 点赞
$('.beauty_title_like').one('click',function(){
    var i=$('.beauty_title_like').index(this);
    $('.beauty_title_like img').eq(i).attr('src','../../img/beauty_commont_like_on.png');
    var likeCount=parseInt($('.beauty_title_like span').eq(i).html())+1;
    $('.beauty_title_like span').eq(i).html(likeCount);
})
// 单个评论点赞
$('body').on('click','.commont_like',function(){
    var i=$('.commont_like').index(this);
    $('.commont_like img').eq(i).attr('src','../../img/all_commont_like_on.png');
    var likeCount=parseInt($('.commont_like span').eq(i).html())+1;
    $('.commont_like span').eq(i).html(likeCount);
})
// 收藏
$('.beauty_collect').click(function() {
    if($('.beauty_collect').hasClass('has_collect')){
        $('.beauty_collect img').attr('src','../../img/beauty_commont_collect.png');
        $('.beauty_collect span').html('收藏');
        $('.beauty_collect').removeClass('has_collect');
    }else{
        $('.beauty_collect img').attr('src','../../img/beauty_commont_collect_on.png');
        $('.beauty_collect span').html('已收藏');
        $('.beauty_collect').addClass('has_collect');
    }
})
// 点击
$('.beauty_commont').on('click',function(){
    if($('.beauty_commont').html()=="请输入评论内容"){
        $('.beauty_commont').empty();
    }
    $('.beauty_commont').trigger('focus');
    setTimeout(function(){
        document.body.scrollTop = document.body.scrollHeight;
    },300);
})
// 确认发布评论事件
$('body').on('keypress', function(event) { 
    if (event.keyCode == "13") {              
        event.preventDefault();
        if($('.beauty_commont').html()==""){
            alert('请输入评论内容');
        }else{
            alert($('.beauty_commont').html())
        }
    }
});


</script>
</html>